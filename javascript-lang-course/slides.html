<!doctype html>  
<html lang="en">
	
	<head>
		<meta charset="utf-8">
		
		<title>Javascript Basics</title>

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
		
		<link rel="stylesheet" href="../reveal.js/css/main.css">
		<link rel="stylesheet" href="../reveal.js/css/theme/simple.css" id="theme">
		
		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">

		<!-- jw styles -->
		<link rel="stylesheet" href="../reveal.js/jayway-theme/css/style.css" id="jayway-theme">

	<!-- Stylesheet -->
	<link href="sandbox.css" rel="stylesheet"/>
		
		<script>
			// If the query includes 'print-pdf' we'll use the PDF print sheet
			document.write( '<link rel="stylesheet" href="../reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>


	<!-- Templates -->
	
	<!-- The sandbox template: -->
	<script type="text/template" id="tplSandbox">
		<pre class="output"></pre>
		<div class="input">
			<textarea rows="1" placeholder="<%= placeholder %>"></textarea>
		</div>
	</script>

	<!-- The command/result template (NB whitespace/line breaks matter inside <pre> tag): -->
	<script type="text/template" id="tplCommand"><% if (! _hidden) { %><span class="command"><%= command %></span>
<span class="prefix"><%= this.resultPrefix %></span><span class="<%= _class %>"><%= result %></span>
<% } %></script>


	<!-- Scripts -->

	<!-- Underscore, Backbone, backbone-localStorage, jQuery -->
	<script src="libs/underscore.min.js"></script>
	<script src="libs/backbone.min.js"></script>
	<script src="libs/backbone-localStorage.min.js"></script>
	<script src="libs/jquery.min.js"></script>

	<!-- The JS Sandbox Console script (requires underscore, backbone and jquery): -->
	<script src="sandbox-console.js"></script>
	
	<!-- When ready, create the model and view -->
	<script type="text/javascript">
		jQuery(document).ready(function($) {
			// Create the sandbox:
			window.sandbox = new Sandbox.View({
				el : $('#sandbox1'),
				model : new Sandbox.Model({
					iframe : true,  // evaluate commands inside a hidden iframe (default: false)
					fallback : true // use global eval if iframe isn't available (default: true)
				})
			});

			window.sandbox = new Sandbox.View({
				el : $('#sandbox2'),
				model : new Sandbox.Model({
					iframe : true,  // evaluate commands inside a hidden iframe (default: false)
					fallback : true // use global eval if iframe isn't available (default: true)
				})
			});

		});
	</script>


		<!--[if lt IE 9]>
		<script src="../reveal.js/lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>
	
	<body>
		
		<div class="reveal">

	   	<img src="../reveal.js/jayway-theme/img/jayway-logo.png" class="jayway-logo header">

			<!-- Used to fade in a background when a specific slide state is reached -->
			<div class="state-background"></div>

			
			<!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

        <section>
          <h1>JavaScript Basics</h1>
          <p>Jayway Course</p>
          <p>
          <br>
          </p>
        </section>

        <section>
          <h2>Why JavaScript?</h2>
          <div>It's everywhere!</div>
          <div>(placeholder)</div>
        </section>

        <section>
          <h1>Early History</h1>
          <h2>LiveScript/Mocha - 1994-95</h2>
          <p>Developed by Brendan Eich at Netscape</p>
          <p>Intended as a light-weight Java-alternative</p>

          <h2>JavaScript, 1995-96</h2>
          <p>Included in Netscape Navigator 2.0</p>
          <p>Included in Microsoft IE 3.0, 1996</p>
          <p>(MS later renamed it <b>JScript</b>)</p>
          <p></p>
          <p>Standardized as <b>ECMAScript</b>, 1997</p>
        </section>

        <section>
          <h1>History, 2000-</h1>
          <p>ECMAScript goes up to revision 5</p>
          <p>Browser vendors race for highest performance</p> 
          <p>Google Chrome comes out in 2008 (V8)<p>
          <p>Enables high performance apps like node.js</p>
          <p>Many JavaScript engines still in heavy development today</p>
        </section>

        <section data-markdown>
          Language Syntax
          ---------------
        </section>

        <section data-markdown>
            ### Whitespace

            Use secimolons, example:
                
                a = b + c
                (d + e).foo()
 
                // Treated as:
                //   a = b + c(d + e).foo();
        </section>

        <section data-markdown>
            ### Variable
               
                var x;  // declared but not defined
                var y = 0;
                z = 1; // always global scope

        </section>

        <section data-markdown>
            ### Nine Types
            * Numbers, e.g. 5
            * Strings, e.g. 'foo', "foo" (sometimes boxed)
            * Booleans, true false (sometims boxed)
            * null
            * undefined
            * Arrays, e.g. [1,2,3] (always boxed)
            * Object, e.g. {foo: 'bar'}, always boxed.
            * Regular Expressions, e.g. /foo\s*([bar]+)/. Always boxed
            * Functions
        </section>


        <section data-markdown>
            Numbers
            -------

            ### Numbers
            _Represents both integers and reals. 64 bit representation._
            Integral values range: +/- 9007199254740992:

                var a = 352661;
                var b = 334.22;

            Special values:

                NaN
                +Infinity
                -Infinity

        </section>

        <section data-markdown>
            ### Numbers

                test("Strange arithmetic", function() {
                    var a = NaN;
                    equals( a &lt;  10, false, "bigger than 10");
                    equals( a &gt;  10, false, "smaller than 10");
                    equals( a === 10, false, "not equal to 10");
                    equals( a === NaN, false, "not NaN??? " );
                    equals( isNaN( a ), true, "Ahh!!" );
                });


            _Caveat: some operators only work on 32 bit numbers. A silent conversion
            will be performed by the operator._
        </section>

        <section data-markdown>
            ### Strings

                //example:
                var txt  = 'Hello World!';
                var txt2 = "I'm happy" + " happy";

            _Sequence of 16 bit elements interpreted as UTF-16._

            Useful operators:

                //split
                txt.split( ' ' );
                //substring:
                txt.substring( 5 );
                txt.substring( 2, 5 );
                parseInt(“1234blue”); //returns 1234
                parseInt(“0xA”); //returns 10
                parseInt(“22.5”); //returns 22
                parseInt(“blue”); //returns NaN
                parseFloat(“1234blue”); //returns 1234.0
                parseFloat(“0xA”); //returns NaN
                parseFloat(“22.5”); //returns 22.5

        </section>

        <section data-markdown>
            ### Booleans

                //Two possible values: true or false
                var a = true;
                var b = a &amp;&amp; ( a == false );

        </section>

        <section data-markdown>
            ### undefined and null

            _Anything unassigned or not declared has the value 'undefined'._

            null is a special value meaning "no value".

                equals( "object", typeof null, "type of null is 'object'");

        </section>

        <section data-markdown>
            ### undefined and null

            _On the other hand, undefined means that the variable has not been declared, or has not been given a value._
        </section>

        <section data-markdown>
            Equality and Comparison
            -----------------------

            '==' can produce confusing results

                equals( false, '' == '0' );
                equals( true, 0 == '' );
                equals( true, 0 == '0' );

                equals( false, false == 'false' );
                equals( true, false == '0' );

                equals( false, false == undefined );
                equals( false, false == null );
                equals( true, null == undefined );

                equals( true, ' \t\r\n ' == 0 );

        </section>


        <section data-markdown>
          ### Excercise

          * typeof null ?
          * 'x' == new String('x') ? with === ?
          * typeof unknownVariable ?
          * null == undefined and null === undefined
          * undefined || 'Hello'
          * "Hello " + undefined + 2

        </section>
        <section>
          <p>Excercise</p>

     	  <div class="sandbox" id="sandbox1">sandbox console loading...</div>
        </section>

        <section data-markdown>
            ### Functions

            # First Class Citizen

        </section>

        <section data-markdown>
            ### Function Statement

                function foo() {}

            expands to

                var foo = function foo() {};

        </section>

        <section data-markdown>
            ## Anonymous Functions

                var f = function(a, b) { return a + b; }
        </section>

        <section data-markdown>
            ### Invokation

            by parenthesis

                //Example:
                var greeter = function() { return 'hello'; }
                
                greeter // a reference to the function
                greeter() // invocation of the function
                equals( 'hello', greeter(), 'invocation')

        </section>

        <section data-markdown>
            ### Arguments

            Arguments bound if present, e.g:

                (function (x, y) {return x + y}) (’foo’)  # => ’fooundefined’
                
        </section>

        <section data-markdown>
            ### Lazy Scoping

               var bar = function () {return bar};
               bar () === bar              // => true

        </section>

        <section data-markdown>
            ### First Class Citizen

            means

            * Can be arguments to functions
            * Can be returned from functions

        </section>

        <section data-markdown>
            ### Example

                _f('whack')();

            `_f` is a function returning a function

        </section>

       <section data-markdown>
            ### Returning Functions

                var sayHello = function() {
                  return function() { return "Hello " + name; }
                };
                var helloMe = sayHello('andreas');
                helloMe(); // => "Hello andreas"
        </section>

        <section data-markdown>
            ### Excercise

            * An ananymous function returning your name.
            * A function with one function arg that append "Hello" to the function argumentent's return value.

        </section>

        <section>
          <p>Excercies</p>
     	  <div class="sandbox" id="sandbox2">sandbox console loading...</div>
       </section>

        <section data-markdown>
            ### if else if else

                if (a === b) {
                   "a equals b";
                } else if (a === c) {
                   "a equals c";
                } else {
                   "a does not equal either b or c";
                }

            Or 

                a === b ? "a equal b" : "a not equal b"
        </section>

        <section data-markdown>
            ### Boolean Operators && ||
        </section>


        <section data-markdown>
            ### while

                while (c < 10) {
                   c += 1;
                   // ...
                }
        </section>

        <section data-markdown>
            ### while

                while (c < 10) {
                   c += 1;
                   // ...
                }
        </section>

        <section data-markdown>
            ### do... while

                do {
                   c += 1;
                } while (c < 10)  

        </section>


        <section data-markdown>
            ### switch

                switch(i) {
                  case 1:
                     // ...
                     break;
                  case 2:
                     // ...
                    break;
                  default:
                    // ...
                  break;
                }

        </section>

        <section data-markdown>
            ### for

                var c;
                for (c = 0; c < 10; c += 1) {
                  // ...
                }
            Or

                for (var number = 0; number <= 12; number = number + 2)
                   show(number);

        </section>

        <section data-markdown>
            ### break 

                for (i=0;i<10;i++)
                {
                   if (i==3) break;
                   x=x + "The number is " + i + "<br />";
                }

        </section>


        <section data-markdown>
            ### continue

                for (i=0;i<=10;i++)
                {
                   if (i==3) continue;
                   x=x + "The number is " + i + "<br />";
                }
        </section>


        <section data-markdown>
            ### try catch finally

                try{
                  undefinedfunction();
                  alert('I guess you do exist');
                }
                catch(e){
                  alert('An error has occurred: '+e.message);
                }
                finally{
                  alert('I am alerted regardless of the outcome above');
                }

        </section>


        <section data-markdown>
            ### Throw

                throw "Oops" // no stack trace

                throw new Error("Ooops") // now with stack trace

        </section>

        <section data-markdown>
            ## Arrays
       
            * Array inherits from object
            * Indexes are converted to strings
        </section>

        <section data-markdown>
            ## Arrays

            * [ ]
            * names =  [ ‘Rudolph’, ‘Kjell’, ‘Torsten’]
            * typeof value == ‘object’
            * value.constructor === Array
        </section>

        <section data-markdown>
            ## Array Methods

            * concat
            * join
            * pop
            * push
            * slice
            * sort
            * splice
            * length
        </section>

        <section data-markdown>
            ### Exerices
             
            Write function: sum([1,2,3]) # => 6

        </section>

        <section data-markdown>
            ## Objects

            * Object literals
            * Properties
            * Methods
            * Prototypes
            * Inheritance

        </section>


        <section data-markdown>
            ### Objects

            An object is a container of keys and values, i.e. a map.

                { name: 'John', age: function() {
                    return differenceInYears( new Date(1973,3,5), new Date())
                } }

        </section>


	<section>
	    <p>Object Literal</p>
            <pre><code>
var myObject = {
  name: 'andreas',
  sayHello: function() { alert("hello") }
}
myObject.sayHello();
            </code></pre>
        </section>

	<section>
	    <p>Retrieval</p>
            <pre><code>
var flight = {
  airline: "Oceanic",
  departure : {       
    IATA: "SYD",
    time: "2004-09-22 14:55",
    city: "Sydney"
  }
}
flight.departure.city;
// Same as
flight["departure"]["city"];            
            </code></pre>
        </section>

	<section>
	    <p>Non-existent properties</p>
            <pre><code>
flight.foo // undefined
flight['foo'] // undefined
flight.foo.city; // undefined
            </code></pre>
        </section>

	<section>
	    <p>Setting Non-existent properties</p>
            <pre><code>
flight.foo = 'bar';
flight['baaz'] = 42
            </code></pre>
        </section>

	<section>
            <pre><code>
delete flight.foo
flight.foo // undefined
            </code></pre>
        </section>


        <section data-markdown>
            ### Prototype-based programming

            * OO without classes !
            * Inheritance by object delegation
       </section>

       <section>
	    <p>Prototype Delegation</p>
             <pre><code>
var foo = {name: "foo", one: 1, two: 2};
var bar = {two: 'two'};
// Make bar delegate method calls the prototype foo:
bar.__proto__ = foo;  // don't do this !
bar.one // Resolves to 1.
bar.two // Resolves to 'two'
delete bar.two
bar.two // Resolves to 2
            </code></pre>
       </section>
                 
	<section>
	    <p>Object.create</p>
            <pre><code>
var foo = {name: "foo", one: 1, two: 2};
var bar = Object.create(foo); // do this !
bar.one // Resolves to 1.
bar.two // Resolves to 'two'
            </code></pre>
        </section>

       <section>
	    <p>Prototypal Inheritance</p>
            <pre><code>
var foo = {
    name: "foo",
    sayHello: function() {
        alert("hello from " + this.name);
    }
};
foo.sayHello();
            </code></pre>
      </section>

       <section>
	    <p>Prototypal Inheritance</p>
            <pre><code>
var foo = {
    name: "foo",
    sayHello: function() {
        alert("hello from " + this.name);
    }
};

var bar = Object.create(foo);
bar.sayGoodbye = function() {
    alert("goodbye from " + this.name);
}
bar.sayHello();
bar.sayGoodbye();
            </code></pre>
      </section>

        <section data-markdown>
JavaScript does not have classes, but we can program as though it does.

### 

### But is not needed !

        </section>

        <section data-markdown>
### The Constructor Functions

        function Pet(species){
           this.species = species;
           this.sayHello = function() { 
              return "Hello " + this.species;
           }
        }

        var cat = new Pet('cat');
        cat.sayHello(); 
        </section>
        
        <section data-markdown>
### Classes and Inheritance

"I have never once found need to use an uber function. The super idea is fairly important in the classical pattern, but it appears to be unnecessary in the prototypal and functional patterns. I now see my early attempts to support the classical model in JavaScript as a mistake."

Douglas Crockford

        </section>


        <section data-markdown>
            ## Built-in Prototypes
            * Object.prototype
            * Array.prototype
            * Function.prototype
            * Number.prototype
            * String.prototype
            * Boolean.prototype
        </section>

       <section data-markdown>
           ## Extending

               Array.prototype.last = function() {
                   return this[this.length - 1];
               };

               [1.2.3].last(); // => 3
        </section>

        <section data-markdown>
            ### Excercise

            TODO

        </section>

        <section data-markdown>
            ## JSON

            * A subset of javascript
            * JavaScript Object Notation 
                * objects
                * arrays
                * strings
                * numbers
                * booleans
                * null
        </section>

        <section>
            <p>JSON</p>
            <pre><code>
            var flight = {
                airline: "Oceanic",   // string
                number: 815,          // number
                departure : {          // object
                    IATA: "SYD",
                    time: "2004-09-22 14:55",
                    city: "Sydney"
                },
                arrival : {            // object
                    IATA : "LAX",
                    time : "2004-09-23 10:42",
                    city : "Los Angeles"
                }
            };
            </code></pre>
        </section>

        <section>
            <p>JSON</p>
            <pre><code>
                // array of objects
                var array = [
                    {
                        firstName : "John",
                        lastName  : "Doe",
                        mobile    : 2353,
                        loggedin  : true
                    },
                    {
                        firstName : "Mary",
                        lastName  : "Smith",
                        mobile    : 3243,
                        loggedin  : false
                    },
                    {
                        firstName : "Fax",
                        lastName  : "",
                        mobile    : 1234,
                        loggedin  : null
                    }
                ];
            </code></pre>
        </section>

        <section data-markdown>
            ## Scope

            The function is the scope of the variables.
        </section>

        <section data-markdown>
            ## Global Scope

                var iAmGlobal = 42;
                var x = function(){ 
                   var secret = 1;
                   return iAmGlobal + 1;
                }(); # => 43
               
                secret # => ReferenceError: secret not defined

        </section>

        <section data-markdown>
            ## This

            Refers to: how we get into the neighborhood 

                var x = { 
                  name: 'andreas',
                  me: function() { return this.andreas; }
                };

                # Calling an Object's Method:
                x.me(); # => 'andreas'

                var y = x.me
                y(); # => ""  !!!
                this.name = 'root';
                y(); #=> 'root'
        </section>

        <section data-markdown>
            ## Root Context

                function test_this() { 
                   return this; 
                } 
                var i_wonder_what_this_is = test_this(); 

            this reference the window object

            (for browsers)
        </section>

        <section>
            Eventhandling

            <pre><code>
  function click_handler() { 
   alert(this); // alerts the window object 
  } 

 button id='thebutton' onclick='click_handler()'>Click me!</button>
            </code></pre>
This is the DOM element clicked

        </section>

        <section data-markdown>
            ## Manipulating Context/this

            * apply
            * call

        </section>

        <section data-markdown>
            ## Call

                 var first_object = { 
                  num: 42 
                 }; 
                 var second_object = { 
                  num: 24 
                 }; 
  
                 function multiply(mult) { 
                  return this.num * mult; 
                 } 
  
                 multiply.call(first_object, 5); // returns 42 * 5 
                 multiply.call(second_object, 5); // returns 24 * 5 
        </section>

        <section data-markdown>
            ## Apply

            Similar to call, but with args as an array:

                multiply.apply(first_object, [5]); // returns 42 * 5 
                multiply.apply(second_object, [5]); // returns 24 * 5 
        </section>

        <section data-markdown>
            ## Dynamic Compilation
            * eval
                * Evaluates a string and returns the result.
            * new Function(parameterArray, codeString)
                * Creates and returns a function.
                * var add=new Function("a", "b", "return a+b;");
        </section>

        <section data-markdown>
            ## Best Practices
        </section>

        <section data-markdown>
            ## Modules

                var MyNamespace = {};
                var MyNS = MyNS || {};
        </section>

        <section data-markdown>
            ## Cascade

                setFirst: function(name) {
                  this.first = name;
                  return this;
                } 
                person
                .setFirst(“Anders”)
                .setLast(“Janmyr”)
                .setAge(40);
       </section>

        <section data-markdown>
            ## Encapsulation

                var Esperanto = Esperanto || {};

                Esperanto.Lab = function() {
                    var privVar = "example";
                    function privFunc() {
                        return privVar;
                    }
                    return {
                        example: function() {
                            return privFunc();
                        }
                    }
                }()

        </section>


        <section data-markdown>
            ## Local Functions

                costData: function(current) {
                    var data = {};
                    function addEntry(name, cost) {
                        data[name + "PerHour"] = model.withTwoDec(cost/hours);
                        data[name] = model.noDecimalsWithSeparator(cost);
                    };

                    addEntry("interest", this.financialCost(current)),
                    addEntry("depreciation", this.depreciationCost(current)),
                    return data;
                },
        </section>

        <section data-markdown>
            ## self = this

                attachFormListener: function(form, object) {
                    var self = this;
                    function populator(event) {
                        self.populateFromForm(form, object);
                        object.notify();
                    };
                    form.getElements().each(function(child) {
                    child.observe('change', populator);
                    });
                },
        </section>

        <section data-markdown>
            ## Mixins

                Object.mixin = function(destination, source) {
                   for (property in source) 
                        destination[property] = source[property];
                   return destination;
                }
        </section>


        <section data-markdown>
            ### javascript gotchas

            Be aware of:
 
                "1" == 1 // true

            Advice:
 
                Number("1") === 1

        </section>

        <section data-markdown>
            ### parseInt doesn't assume base-10

            Be aware of:
 
                parseInt("8"); //8
                parseInt("08"); //0

            Advice:
 
                parseInt("8", 10); //8
                parseInt("08", 10); //8

        </section>


        <section data-markdown>
            ### instanceof

            Be aware of:

                "hello" instanceof String; //false
                new String("hello") instanceof String; //true

        </section>


        <section data-markdown>
            ### instanceof

            Be aware of:

                typeof [1,2,3]  // 'object'
                [1,2,3] instanceof Array // true

        </section>

        <section data-markdown>
            ### Objects and Literals

            Be aware of:

                var a = new Object();
                var b = new Boolean(true);
                new Array("one", "two")
                new Function("hello" "");

            Advice, use literals

                var a = {}
                var b = false;


        </section>

        <section data-markdown>
            ### Final Advice

            Use JSLint !

        </section>

        <section data-markdown>
            ### Example

        </section>

        <section data-markdown>
            Learning Javascript
            ===================

            * Online resources
            * Standard library
            * Common pitfalls
        </section>

        <section data-markdown>
            Future of Javascript
            ====================
        </section>
      </div>

			<!-- The navigational controls UI -->
			<aside class="controls">
				<a class="left" href="#">&#x25C4;</a>
				<a class="right" href="#">&#x25BA;</a>
				<a class="up" href="#">&#x25B2;</a>
				<a class="down" href="#">&#x25BC;</a>
			</aside>

			<!-- Presentation progress bar -->
			<div class="progress"><span></span></div>
			
		</div>

		<script src="../reveal.js/lib/js/head.min.js"></script>
		<script src="../reveal.js/js/reveal.min.js"></script>

		<script>
			
			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				
				theme: Reveal.getQueryHash().theme || 'default', // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/linear(2d)

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../reveal.js/lib/js/highlight.js', async: true, callback: function() { window.hljs.initHighlightingOnLoad(); } },
					{ src: '../reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../reveal.js/lib/js/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../reveal.js/lib/js/data-markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '/socket.io/socket.io.js', async: true, condition: function() { return window.location.host === 'localhost:1947'; } },
					{ src: 'plugin/speakernotes/client.js', async: true, condition: function() { return window.location.host === 'localhost:1947'; } },
				]
			});
			
		</script>

	</body>
</html>
